import{s as c}from"./index-B62kerm1.js";class b{constructor(t,e){this.type=t,Object.assign(this,e),this.prevented=!1,this.dispatched=!1;for(const i in e)typeof e[i]=="function"&&e[i]instanceof Function&&(this[i]=e[i].bind(this))}prevent(){this.prevented=!0}dispatch(){this.dispatched=!0}}class m{constructor(){this.Event=b,this.listeners=[],this.events={}}on(t,e,i={}){return this.events[t]||(this.events[t]=[]),this.events[t].push({callback:e,option:i}),()=>{this.off(t,e,i)}}off(t,e,i){if(!Array.isArray(this.events[t]))return;let o=[];this.events[t].forEach((s,a)=>{s.callback===e&&o.push(a)}),i&&(o=o.filter(s=>this.events[t][s].option===i)),o.forEach(s=>{this.events[t].splice(s,1)})}emit(t,e={},...i){const o=this.events[t]||[],s=new this.Event(t,e),a=[];for(const l of o){l.callback(s,...i);const n=l.option;if(n&&n.once===!0&&a.push({name:t,callback:l.callback,conf:n}),s.dispatched)break}return a.forEach(l=>{this.off(l.name,l.callback,l.conf)}),s}}class v extends m{constructor(t={}){if(super(),this.userData={games:[],usedWords:[]},this._activeInp=null,this._activeLine=null,this.ui=c.state.ui,this.op={words:[],holder:"#wordle",letters:[],mode:"easy"},Object.assign(this.op,t),this.words=this.op.words,this.box=document.querySelector(this.op.holder),!this.box){console.error("Holder doesnt exist");return}}get activeLine(){return this._activeLine}set activeLine(t){var e;(e=this._activeLine)==null||e.querySelectorAll(".sym").forEach(i=>{i.classList.remove("active")}),t==null||t.querySelectorAll(".sym").forEach(i=>{i.classList.add("active")}),this._activeLine=t}get activeInp(){return this._activeInp}set activeInp(t){var e;(e=this.activeInp)==null||e.classList.remove("focus"),t==null||t.classList.add("focus"),this._activeInp=t}init(){this.initCore(),this.initKeyboard(),this.newGame()}initCore(){this.ui.add(this.op.holder,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"10px",padding:"10px",borderRadius:"12px",height:"100%",width:"100%",backgroundColor:"rgb(var(--bg-st), 0.8)"}),this.ui.add(".canvasCont",{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"65%"}),this.canvasCont=document.createElement("div"),this.canvasCont.classList.add("canvasCont"),this.box.appendChild(this.canvasCont),this.on("win",()=>{this.state.gameEnd=!0,this.state.win=!0,this.state.attempts&&this.userData.games.push(this.state)}),this.on("loss",()=>{this.state.gameEnd=!0,this.state.attempts&&this.userData.games.push(this.state)})}initCanvas(){this.ui.add(".canvasBox",{display:"flex",flexDirection:"column",alignItems:"center",gap:"2vh",width:"10%",height:"100%"}),this.ui.add(".inputBox",{flex:"1 0",width:"100%",display:"flex",gap:"2vw",alignItems:"center",justifyContent:"center"}),this.ui.add(".sym",{flex:"1 0 45px",aspectRatio:"1 / 1",display:"flex",fontSize:"120%",alignItems:"center",justifyContent:"center",borderRadius:"8px",border:"1px solid rgb(var(--color-nd))",transition:"transform 0.3s cubic-bezier(0.25, 1, 0.5, 1)","&.active":{border:"1px solid rgb(var(--color))"},"&.focus":{transform:"scale(1.1)"},"&.green":{backgroundColor:"rgba(var(--success), 0.5)"},"&.grey":{backgroundColor:"rgba(var(--grey), 1)"},"&.yellow":{backgroundColor:"rgba(var(--warning), 0.5)"}});const t=document.createElement("div");t.classList.add("canvasBox");const e=i=>{const o=a=>{const l=document.createElement("div");return l.setAttribute("data-idx",`${a}`),l.classList.add("sym"),l},s=document.createElement("div");s.setAttribute("data-id",`${i}`),s.classList.add("inputBox");for(let a=0;a<5;a++)s.appendChild(o(a));return s};for(let i=0;i<6;i++)t.appendChild(e(i));this.canvasCont.innerHTML="",this.canvasCont.appendChild(t)}initKeyboard(){this.ui.add(".lettersBox",{display:"flex",flexDirection:"column",alignItems:"center",gap:"2vh",width:"100%",maxWidth:"550px",height:"35%"}),this.ui.add(".lettersLine",{width:"auto",display:"flex",gap:"1vw",alignItems:"center",justifyContent:"center"}),this.ui.add(".letter",{all:"unset",aspectRatio:"1 / 1",flex:"1 0 45px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"120%",borderRadius:"8px",backgroundColor:"rgba(var(--bg-nd), 0.7)",transition:"transform 0.3s cubic-bezier(0.25, 1, 0.5, 1)","&:active":{transform:"scale(0.9)"},"&.green":{backgroundColor:"rgba(var(--success), 0.5)"},"&.grey":{backgroundColor:"rgba(var(--grey), 1)"},"&.yellow":{backgroundColor:"rgba(var(--warning), 0.5)"}}),this.ui.add(".opLine",{padding:"0 20px",width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between"}),this.ui.add(".optionBtn",{all:"unset",flex:"0.2 0",cursor:"pointer",aspectAsio:"3 / 1",display:"flex",alignItems:"center",fontSize:"125%",justifyContent:"center",borderRadius:"8px",backgroundColor:"rgb(var(--bg-nd), 0.7)",padding:"5px",transition:"transform 0.3s cubic-bezier(0.25, 1, 0.5, 1)","&:active":{transform:"scale(0.9)"}});const t={"main .optionBtn":{flex:"0.1 0"},"main .letter":{flex:"1 0 30px"}};this.ui.add("@media screen and (max-width: 580px)",t),this.ui.add("@media screen and (min-height: 750px)",t);const e=n=>{const r=document.createElement("button");return r.setAttribute("data-letter",n),r.textContent=n,r.addEventListener("click",()=>{if(this.state.gameEnd)return;this.activeInp&&!this.activeInp.textContent&&(this.activeInp.textContent=n);const h=this.nextInp();h&&(this.activeInp=h)}),r.classList.add("letter"),r},i=document.createElement("div");i.classList.add("lettersBox");const o=document.createElement("div");o.classList.add("opLine");const s=document.createElement("button");s.addEventListener("click",()=>{if(!this.activeLine||this.state.gameEnd)return;const n=this.activeLine.querySelectorAll(".sym"),r=(d,g)=>{const f=i.querySelector(`[data-letter="${d}"]`);f&&(f.className="letter "+g)};let h=!1;if(n.forEach(d=>{d.textContent===""&&(h=!0)}),h)return;let u=!0;if(n.forEach((d,g)=>{d.textContent!==this.state.word[g]?(u=!1,this.state.word.indexOf(d.textContent)!==-1?(d.classList.add("yellow"),r(d.textContent,"yellow")):(d.classList.add("grey"),r(d.textContent,"grey"))):(d.classList.add("green"),r(d.textContent,"green"))}),u){this.emit("win");return}else if(this.activeLine.getAttribute("data-id")==="5"){this.emit("loss");return}this.nextLine()}),s.textContent=c.state.lang.keyboard.enter,s.classList.add("optionBtn"),o.appendChild(s);const a=document.createElement("button");a.addEventListener("click",()=>{if(this.state.gameEnd)return;const n=this.activeInp;if(!n)return;if(n.textContent!==""){n.textContent="";return}const r=this.lastInp();r&&(r.textContent="",this.activeInp=r)}),a.textContent=c.state.lang.keyboard.backspace,a.classList.add("optionBtn"),o.appendChild(a),i.appendChild(o);const l=n=>{const r=document.createElement("div");r.classList.add("lettersLine"),n.forEach(h=>{const u=e(h);r.appendChild(u)}),i.appendChild(r)};this.op.letters.forEach(n=>{l(n)}),this.box.appendChild(i)}clearKeyboard(){this.box.querySelectorAll(".letter").forEach(e=>{e.className="letter"})}newGame(){this.clearKeyboard(),this.state={attempts:0,word:this.getWord(),win:!1},console.log(this.state.word),this.initCanvas(),this.activeLine=this.canvasCont.querySelector(".inputBox"),this.activeInp=this.activeLine.querySelector(".sym")}nextLine(){if(!this.activeLine)return;this.state.attempts+=1;let t=Number(this.activeLine.getAttribute("data-id"))+1;const e=this.canvasCont.querySelector(`[data-id="${t}"]`);e&&(this.activeLine=e,this.activeInp=e.querySelector(".sym"))}nextInp(){const t=this.activeInp;if(!t||!this.activeLine)return null;let e=t.getAttribute("data-idx");return!e||e==="5"?null:(e=Number(e),this.activeLine.querySelector(`[data-idx="${e+=1}"`))}lastInp(){const t=this.activeInp;if(!t||!this.activeLine)return null;let e=t.getAttribute("data-idx");return!e||e==="0"?null:(e=Number(e),this.activeLine.querySelector(`[data-idx="${e-=1}"`))}getWord(){if(this.op.mod==="easy"){let e=Math.floor(Math.random()*this.words.length);return this.userData.usedWords.push(this.words[e]),this.words[e]}let t="";do{let e=Math.floor(Math.random()*this.words.length);t=this.words[e]}while(this.userData.usedWords.includes(t));return this.userData.usedWords.push(t),t}}class y{constructor(t){this.ui=c.state.ui,this.main=document.querySelector("main"),this.router=t,window.addEventListener("beforeunload",()=>{this.saveData()}),document.title="Wordle"}init(){this.initUI(),this.initContent(),this.initLogPanel()}initUI(){const t=this.ui.env("main");this.ui.add(".wordleBox",{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}),t(),this.ui.add(".log-panel",{position:"absolute",zIndex:"5",padding:"10px",width:"auto",height:"auto",display:"flex",flexDirection:"column",borderRadius:"12px",alignItems:"center",boxShadow:"0px 4px 10px rgba(0, 0, 0, 0.1)",backgroundColor:"rgba(var(--bg-nd), 0.8)",justifyContent:"center",opacity:"0",transform:"translate(-10%, -50%)",transition:"opacity 0.5s cubic-bezier(0.25, 1, 0.5, 1), transform 0.5s cubic-bezier(0.25, 1, 0.5, 1)","&.show":{opacity:"1",transform:"translate(0%, -50%)"}}),this.ui.add(".log-panel-content",{display:"flex",width:"100%",height:"100%",alignItems:"center",justifyContent:"center",flexDirection:"column",fontSize:"100%",gap:"5px"}),this.ui.add(".log-panel-option",{width:"100%",padding:"10px",display:"flex",alignItems:"center",justifyContent:"center",button:{all:"unset",display:"flex",alignItems:"center",justifyContent:"center",padding:"5px 10px",borderRadius:"8px",cursor:"pointer",backgroundColor:"rgba(var(--component), 0.7)"}})}initContent(){this.box=document.createElement("div"),this.box.classList.add("wordleBox"),this.main.appendChild(this.box),this.wordle=document.createElement("div"),this.wordle.setAttribute("id","wordle"),this.box.appendChild(this.wordle);const t=["qwertyuiop".split(""),"asdfghjkl".split(""),"zxcvbnm".split("")],e=["йцукенгшщзх".split(""),"ъфывапролдж".split(""),"эячсмитьбю".split("")],i={"ru-RU":e,"en-US":t,en:t,ru:e},o=["about","alert","argue","beach","above","alike","arise","began","abuse","alive","array","begin","actor","allow","aside","begun","acute","alone","asset","being","admit","along","audio","below","adopt","alter","audit","bench","adult","among","avoid","billy","after","anger","award","birth","again","angle","aware","black","agent","angry","badly","blame","agree","apart","baker","blind","ahead","apple","bases","block","alarm","apply","basic","blood","album","arena","basis","board","boost","buyer","china","cover","booth","cable","chose","craft","bound","calif","civil","crash","brain","carry","claim","cream","brand","catch","class","crime","bread","cause","clean","cross","break","chain","clear","crowd","breed","chair","click","crown","brief","chart","clock","curve","bring","chase","close","cycle"],s=["время","жизнь","слово","место","конец","часть","город","земля","право","дверь","образ","закон","война","голос","книга","число","народ","форма","связь","улица","вечер","мысль","месяц","школа","театр","рубль","смысл","орган","рынок","семья","центр","ответ","автор","стена","совет","глава","наука","плечо","точка","палец","номер","метод","фильм","гость","кровь","район","армия","класс","герой","спина","сцена","объем","берег","фирма","завод","песня","роман","стихи","повод","успех","выход","текст","пункт","линия","среда","волос","ветер","огонь","грудь","страх","сумма","сфера","мужик","немец","выбор","масса","слава","кухня","отдел","товар"],a={"ru-RU":s,"en-US":o,en:o,ru:s};this.wordleApi=new v({holder:"#wordle",letters:i[c.state.langName]||t,words:a[c.state.langName]});const l=localStorage.getItem("userGameData");l&&(this.wordleApi.userData=JSON.parse(l)),this.wordleApi.init(),this.wordleApi.on("win",()=>{let n=Math.floor(Math.random()*c.st.lang.logPanel.win.length);this.openPanel("<span>"+c.st.lang.logPanel.win[n]+"</span>")}),this.wordleApi.on("loss",()=>{let n=Math.floor(Math.random()*c.st.lang.logPanel.loss.length);this.openPanel("<span>"+c.st.lang.logPanel.loss[n]+`</span><span>${c.st.lang.logPanel.word_was}: <b>${this.wordleApi.state.word}</b></span>`)})}initLogPanel(){this.logPanel=document.createElement("div"),this.logPanel.classList.add("log-panel");const t=document.createElement("div");t.classList.add("log-panel-content"),this.logPanel.appendChild(t);const e=document.createElement("div");e.classList.add("log-panel-option");const i=document.createElement("button");i.addEventListener("click",()=>{this.wordleApi.newGame(),this.closePanel()}),i.textContent=c.st.lang.logPanel.btn,e.appendChild(i),this.logPanel.appendChild(e),document.body.appendChild(this.logPanel)}openPanel(t=""){this.logPanel.classList.add("show"),c.st.app.openOverlay();const e=this.logPanel.querySelector("div");e&&(e.innerHTML=t),setTimeout(()=>{document.addEventListener("click",()=>{this.closePanel(),this.wordleApi.newGame()},{once:!0})},10)}closePanel(){c.st.app.closeOverlay(),this.logPanel.classList.remove("show");const t=this.logPanel.querySelector("div");t&&(t.innerHTML="")}saveData(){localStorage.setItem("userGameData",JSON.stringify(this.wordleApi.userData))}exit(){this.logPanel.remove(),this.main.innerHTML="",this.saveData()}}export{y as default};
